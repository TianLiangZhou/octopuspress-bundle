"use strict";(self.webpackChunkdashboard=self.webpackChunkdashboard||[]).push([[589],{9589:(it,T,l)=>{l.r(T),l.d(T,{PluginModule:()=>st});var u=l(7073),F=l(3911),A=l(2521);const Z="/plugin/upload";var t=l(4565),d=l(898),r=l(2791),p=l(1245),G=l(1784);function k(n,a){if(1&n&&(t.TgZ(0,"a",15),t._uU(1),t.qZA()),2&n){const e=a.$implicit;t.Q6J("href",e.homepage?e.homepage:"javascript:;",t.LSH),t.xp6(1),t.Oqu(e.name)}}function q(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"button",16),t.NdJ("click",function(){t.CHM(e);const s=t.oxw().$implicit,i=t.oxw();return t.KtG(i.remove(s.alias))}),t._uU(1,"\u79fb\u9664"),t.qZA()}}function Q(n,a){if(1&n&&(t.TgZ(0,"a",18),t._uU(1),t.qZA()),2&n){const e=a.$implicit;t.Q6J("href","#"+e.link,t.LSH),t.xp6(1),t.Oqu(e.name)}}function O(n,a){if(1&n&&(t.TgZ(0,"nb-card-footer",11),t.YNc(1,Q,2,2,"a",17),t.qZA()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("ngForOf",e.actions)}}function M(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"div",8)(1,"nb-card")(2,"nb-card-header"),t._uU(3),t.qZA(),t.TgZ(4,"nb-card-body"),t._uU(5),t.qZA(),t.TgZ(6,"nb-card-footer")(7,"div",9)(8,"span"),t._uU(9,"\u4f5c\u8005:"),t.qZA(),t.TgZ(10,"span"),t.YNc(11,k,2,2,"a",10),t.qZA()(),t.TgZ(12,"div",9)(13,"span"),t._uU(14,"\u7248\u672c:"),t.qZA(),t.TgZ(15,"span"),t._uU(16),t.qZA()()(),t.TgZ(17,"nb-card-footer",11),t.YNc(18,q,2,0,"button",12),t.TgZ(19,"button",13),t.NdJ("click",function(){const i=t.CHM(e).$implicit,c=t.oxw();return t.KtG(i.enabled?c.inactivate(i.alias):c.activate(i.alias))}),t._uU(20),t.qZA()(),t.YNc(21,O,2,1,"nb-card-footer",14),t.qZA()()}if(2&n){const e=a.$implicit;t.xp6(3),t.Oqu(e.name),t.xp6(2),t.hij(" ",e.description," "),t.xp6(6),t.Q6J("ngForOf",e.author),t.xp6(5),t.Oqu(e.version),t.xp6(2),t.Q6J("ngIf",!e.enabled),t.xp6(1),t.Q6J("status",e.enabled?"danger":"primary"),t.xp6(1),t.hij(" ",e.enabled?"\u7981\u7528":"\u542f\u7528"," "),t.xp6(1),t.Q6J("ngIf",e.actions.length>0)}}function P(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"nb-card")(1,"nb-card-header"),t._uU(2,"\u5728\u7ebf\u4e0b\u8f7d"),t.qZA(),t.TgZ(3,"nb-card-body"),t._UZ(4,"input",19,20),t.qZA(),t.TgZ(6,"nb-card-footer",11)(7,"button",21),t.NdJ("click",function(){const i=t.CHM(e).dialogRef;return t.KtG(i.close())}),t._uU(8,"\u53d6\u6d88"),t.qZA(),t.TgZ(9,"button",22),t.NdJ("click",function(){const i=t.CHM(e).dialogRef,c=t.MAs(5),m=t.oxw();return t.KtG(m.openDownload(c.value,i))}),t._uU(10,"\u4e0b\u8f7d"),t.qZA()()()}}const E=function(){return["zip"]};let Y=(()=>{class n{constructor(e,o,s,i){this.http=e,this.toast=o,this.route=s,this.dialog=i,this.plugins=[],this.title=""}ngOnInit(){this.getPlugins(),this.route.data.subscribe(e=>{this.title=e.title})}getPlugins(){this.http.get("/plugin/installed").subscribe(e=>{e.records.length>0&&(this.plugins=e.records)})}inactivate(e){this.http.post("/plugin/{name}/deactivate",{name:e}).subscribe(o=>{this.getPlugins()})}activate(e){this.http.post("/plugin/{name}/activate",{name:e}).subscribe(o=>{this.getPlugins()})}upload(e){e.length<1?this.toast.danger("\u4e0a\u4f20\u7684\u63d2\u4ef6\u6587\u4ef6\u4e3a\u7a7a","\u4e0a\u4f20\u63d2\u4ef6"):this.http.post(Z,{uri:e.pop()}).subscribe(o=>{this.getPlugins()})}openDownload(e,o){/https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\+.~#?&//=]*)/.test(e)?this.http.post(Z,{uri:e}).subscribe(i=>{o.close(),this.getPlugins()}):this.toast.danger("\u4e0d\u5408\u6cd5\u7684url\u94fe\u63a5","\u5728\u7ebf\u4e0b\u8f7d")}remove(e){this.http.post("/plugin/{name}/down",{name:e}).subscribe(o=>{this.getPlugins()})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(d.eN),t.Y36(r.quB),t.Y36(p.gz),t.Y36(r.Gln))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-plugin-installed"]],decls:13,vars:4,consts:[[1,"row"],[1,"col-12"],[1,"d-flex","justify-content-between","align-items-center"],[1,"d-flex"],["nbButton","","status","danger",1,"me-2",3,"click"],[3,"suffix","status","finish"],["class","col-12 col-md-6 col-lg-4 col-xl-3",4,"ngFor","ngForOf"],["dialogTpl",""],[1,"col-12","col-md-6","col-lg-4","col-xl-3"],[1,"d-flex","py-3","justify-content-between"],["class","d-inline-block mr-1","target","_blank",3,"href",4,"ngFor","ngForOf"],[1,"d-flex","justify-content-between"],["nbButton","","status","danger",3,"click",4,"ngIf"],["nbButton","",3,"status","click"],["class","d-flex justify-content-between",4,"ngIf"],["target","_blank",1,"d-inline-block","mr-1",3,"href"],["nbButton","","status","danger",3,"click"],["nbButton","","status","primary",3,"href",4,"ngFor","ngForOf"],["nbButton","","status","primary",3,"href"],["nbInput","","name","url","type","url","placeholder","\u4e0b\u8f7d\u5730\u5740"],["url",""],["nbButton","","status","basic",3,"click"],["nbButton","","status","primary",3,"click"]],template:function(e,o){if(1&e){const s=t.EpF();t.TgZ(0,"div",0)(1,"div",1)(2,"nb-card")(3,"nb-card-header",2)(4,"span"),t._uU(5,"\u5df2\u5b89\u88c5\u63d2\u4ef6\u5217\u8868"),t.qZA(),t.TgZ(6,"div",3)(7,"button",4),t.NdJ("click",function(){t.CHM(s);const c=t.MAs(12);return t.KtG(o.dialog.open(c))}),t._uU(8,"\u5728\u7ebf\u4e0b\u8f7d"),t.qZA(),t.TgZ(9,"app-upload",5),t.NdJ("finish",function(c){return o.upload(c)}),t.qZA()()()()(),t.YNc(10,M,22,8,"div",6),t.qZA(),t.YNc(11,P,11,0,"ng-template",null,7,t.W1O)}2&e&&(t.xp6(9),t.Q6J("suffix",t.DdM(3,E))("status","primary"),t.xp6(1),t.Q6J("ngForOf",o.plugins))},dependencies:[u.sg,u.O5,r.Asz,r.yKW,r.XWE,r.ndF,r.DPz,r.h8i,G.o],encapsulation:2}),n})();var K=l(287);function S(n,a){if(1&n&&t._UZ(0,"img",7),2&n){const e=t.oxw().$implicit,o=t.oxw();t.s9C("alt",e.name),t.Q6J("src",o.sanitizer.bypassSecurityTrustResourceUrl(e.image),t.LSH)}}function z(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"div",3)(1,"nb-card")(2,"nb-card-header"),t._uU(3),t.qZA(),t.TgZ(4,"nb-card-body"),t.YNc(5,S,1,2,"img",4),t.qZA(),t.TgZ(6,"nb-card-footer",5)(7,"button",6),t.NdJ("click",function(){const i=t.CHM(e).$implicit,c=t.oxw();return t.KtG(c.setup(i.alias))}),t._uU(8),t.qZA()()()()}if(2&n){const e=a.$implicit;t.xp6(3),t.Oqu(e.name),t.xp6(2),t.Q6J("ngIf",e.image),t.xp6(2),t.Q6J("disabled",e.enabled),t.xp6(1),t.Oqu(e.enabled?"\u5df2\u5b89\u88c5":"\u73b0\u5728\u5b89\u88c5")}}let D=(()=>{class n{constructor(e,o,s,i){this.http=e,this.toast=o,this.route=s,this.sanitizer=i,this.plugins=[],this.title=""}ngOnInit(){this.getPlugins(),this.route.data.subscribe(e=>{this.title=e.title})}getPlugins(){this.http.get("/plugin/market").subscribe(e=>{e.records.length>0&&(this.plugins=e.records)})}setup(e){this.http.post("/plugin/{name}/setup",{name:e}).subscribe(o=>{this.getPlugins()})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(d.eN),t.Y36(r.quB),t.Y36(p.gz),t.Y36(K.H7))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-plugin-market"]],decls:6,vars:1,consts:[[1,"row"],[1,"col-12"],["class","col-12 col-md-6 col-lg-4 col-xl-3",4,"ngFor","ngForOf"],[1,"col-12","col-md-6","col-lg-4","col-xl-3"],["width","100%",3,"alt","src",4,"ngIf"],[1,"d-flex","justify-content-end"],["nbButton","","status","primary",3,"disabled","click"],["width","100%",3,"alt","src"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"nb-card")(3,"nb-card-header"),t._uU(4," \u63d2\u4ef6\u5e02\u573a "),t.qZA()()(),t.YNc(5,z,9,4,"div",2),t.qZA()),2&e&&(t.xp6(5),t.Q6J("ngForOf",o.plugins))},dependencies:[u.sg,u.O5,r.Asz,r.yKW,r.XWE,r.ndF,r.DPz],encapsulation:2}),n})();var v=l(3037),g=l(5086),b=l(8665),H=l(7660);function L(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"angular2-smart-table",8),t.NdJ("create",function(){t.CHM(e);const s=t.oxw(3);return t.KtG(s.create())})("edit",function(s){t.CHM(e);const i=t.oxw(3);return t.KtG(i.edit(s))})("delete",function(s){t.CHM(e);const i=t.oxw(3);return t.KtG(i.delete(s))}),t.qZA()}if(2&n){const e=t.oxw().index,o=t.oxw(2);t.Q6J("settings",o.settings[e])("source",o.source[e])}}function $(n,a){if(1&n&&(t.TgZ(0,"button",15),t._uU(1),t.qZA()),2&n){const e=t.oxw(2).$implicit;t.xp6(1),t.Oqu(e.form.reset.name)}}function j(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"form",9),t.NdJ("submit",function(){t.CHM(e);const s=t.oxw(),i=s.index,c=s.$implicit,m=t.oxw(2);return t.KtG(m.submit(i,c.form.submit.link))}),t._UZ(1,"control-container",10),t.TgZ(2,"div",11),t._UZ(3,"label",12),t.TgZ(4,"div")(5,"button",13),t._uU(6),t.qZA(),t.YNc(7,$,2,1,"button",14),t.qZA()()()}if(2&n){const e=t.oxw(),o=e.$implicit,s=e.index,i=t.oxw(2);t.Q6J("ngClass",o.form.class)("formGroup",i.formGroup[s]),t.xp6(1),t.Q6J("direction",o.form.direction)("form",i.formGroup[s])("controls",o.form.controls),t.xp6(1),t.Tol("column"!==o.form.direction?"row":""),t.xp6(1),t.Tol("column"!==o.form.direction?"col-12 col-md-2":""),t.xp6(1),t.Tol("column"!==o.form.direction?"col-12 col-md-10":""),t.xp6(1),t.Q6J("disabled",o.form.submit.valid&&i.formGroup[s].invalid),t.xp6(1),t.Oqu(o.form.submit.name),t.xp6(1),t.Q6J("ngIf",o.form.reset)}}function R(n,a){if(1&n&&(t.TgZ(0,"nb-tab",7),t.ynx(1,2),t.YNc(2,L,1,2,"angular2-smart-table",4),t.YNc(3,j,8,14,"form",5),t.BQk(),t.qZA()),2&n){const e=a.$implicit,o=a.index;t.Q6J("tabTitle",e.title)("tabIndex",o)("tabId",""+o),t.xp6(1),t.Q6J("ngSwitch",e.container),t.xp6(1),t.Q6J("ngSwitchCase","table"),t.xp6(1),t.Q6J("ngSwitchCase","form")}}function W(n,a){if(1&n&&(t.TgZ(0,"nb-tabset"),t.YNc(1,R,4,6,"nb-tab",6),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.tabs)}}function X(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"angular2-smart-table",8),t.NdJ("create",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.create())})("edit",function(s){t.CHM(e);const i=t.oxw();return t.KtG(i.edit(s))})("delete",function(s){t.CHM(e);const i=t.oxw();return t.KtG(i.delete(s))}),t.qZA()}if(2&n){const e=t.oxw();t.Q6J("settings",e.settings[0])("source",e.source[0])}}function V(n,a){if(1&n&&(t.TgZ(0,"button",15),t._uU(1),t.qZA()),2&n){const e=t.oxw(2);t.xp6(1),t.Oqu(e.form.reset.name)}}function tt(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"form",9),t.NdJ("submit",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.submit(0,s.form.submit.link))}),t._UZ(1,"control-container",10),t.TgZ(2,"div",11),t._UZ(3,"label",12),t.TgZ(4,"div")(5,"button",16),t._uU(6),t.qZA(),t.YNc(7,V,2,1,"button",14),t.qZA()()()}if(2&n){const e=t.oxw();t.Q6J("ngClass",e.form.class)("formGroup",e.formGroup[0]),t.xp6(1),t.Q6J("direction",e.form.direction)("form",e.formGroup[0])("controls",e.form.controls),t.xp6(1),t.Tol("column"!==e.form.direction?"row":""),t.xp6(1),t.Tol("column"!==e.form.direction?"col-12 col-md-2":""),t.xp6(1),t.Tol("column"!==e.form.direction?"col-12 col-md-10":""),t.xp6(1),t.Q6J("disabled",e.form.submit.valid&&e.formGroup[0].invalid),t.xp6(1),t.Oqu(e.form.submit.name),t.xp6(1),t.Q6J("ngIf",e.form.reset)}}let et=(()=>{class n{constructor(e,o,s){this.http=e,this.toast=o,this.route=s,this.title="",this.container="",this.tabs=[],this.settings=[],this.source=[],this.formGroup=[]}ngOnInit(){this.route.paramMap.subscribe(e=>{var o,s;let i=null!==(o=e.get("plugin"))&&void 0!==o?o:"",c=null!==(s=e.get("page"))&&void 0!==s?s:"";this.http.get("/{name}/{feature}",{params:{name:i,feature:c}}).subscribe(m=>{var f;switch(this.title=m.title,this.container=m.container,this.container){case"tabs":this.tabs=m.tabs,this.tabs.forEach((_,h)=>{var x,C;"table"==_.container?(this.source[h]=this.getSource(null===(x=_.table)||void 0===x?void 0:x.source),this.settings[h]=this.getSettings(_.table)):this.formGroup[h]=(0,v.T)(null===(C=_.form)||void 0===C?void 0:C.controls)});break;case"form":this.formGroup[0]=(0,v.T)(null===(f=this.form)||void 0===f?void 0:f.controls),this.form=m.form;break;case"table":this.table=m.table,this.source[0]=this.getSource(this.table.source),this.settings[0]=this.getSettings(this.table)}})})}create(){}edit(e){}delete(e){}getSettings(e){return{actions:{position:"right",add:e.actions.create,edit:e.actions.edit,delete:e.actions.delete,columnTitle:"\u64cd\u4f5c"},add:{addButtonContent:'<i class="nb-plus"></i>',createButtonContent:'<i class="nb-checkmark"></i>',cancelButtonContent:'<i class="nb-close"></i>'},edit:{editButtonContent:'<i class="nb-edit"></i>',saveButtonContent:'<i class="nb-checkmark"></i>',cancelButtonContent:'<i class="nb-close"></i>'},delete:{deleteButtonContent:'<i class="nb-trash"></i>',confirmDelete:!0},pager:{perPage:30},mode:"external",columns:e.columns}}getSource(e){return new g.zV(this.http,{endPoint:e,dataKey:"records",totalKey:"total",pagerPageKey:"page",pagerLimitKey:"limit",filterFieldKey:"#field#"})}submit(e,o){this.formGroup[e].invalid||this.http.post(o,this.formGroup[e].value).subscribe(s=>{})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(d.eN),t.Y36(r.quB),t.Y36(p.gz))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-plugin-feature"]],decls:10,vars:5,consts:[[1,"row"],[1,"col-12"],[3,"ngSwitch"],[4,"ngSwitchCase"],[3,"settings","source","create","edit","delete",4,"ngSwitchCase"],[3,"ngClass","formGroup","submit",4,"ngSwitchCase"],[3,"tabTitle","tabIndex","tabId",4,"ngFor","ngForOf"],[3,"tabTitle","tabIndex","tabId"],[3,"settings","source","create","edit","delete"],[3,"ngClass","formGroup","submit"],[3,"direction","form","controls"],[1,"form-group"],[1,"label","col-form-label"],["status","primary","size","small","nbButton","","type","submit",3,"disabled"],["status","danger","class","ms-2","size","small","type","reset","nbButton","",4,"ngIf"],["status","danger","size","small","type","reset","nbButton","",1,"ms-2"],["status","primary","size","small","type","submit","nbButton","",3,"disabled"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"nb-card")(3,"nb-card-header"),t._uU(4),t.qZA(),t.TgZ(5,"nb-card-body"),t.ynx(6,2),t.YNc(7,W,2,1,"nb-tabset",3),t.YNc(8,X,1,2,"angular2-smart-table",4),t.YNc(9,tt,8,14,"form",5),t.BQk(),t.qZA()()()()),2&e&&(t.xp6(4),t.Oqu(o.title),t.xp6(2),t.Q6J("ngSwitch",o.container),t.xp6(1),t.Q6J("ngSwitchCase","tabs"),t.xp6(1),t.Q6J("ngSwitchCase","table"),t.xp6(1),t.Q6J("ngSwitchCase","form"))},dependencies:[u.mk,u.sg,u.O5,u.RF,u.n9,b._Y,b.JL,b.sg,r.Asz,r.yKW,r.ndF,r.kyn,r.TR4,r.DPz,g.i0,H._],encapsulation:2}),n})();var nt=l(4090);const ot=[{path:"market",title:"\u63d2\u4ef6\u5e02\u573a",component:D},{path:"installed",title:"\u5df2\u5b89\u88c5\u63d2\u4ef6",component:Y},{path:":plugin/:page",component:et}];let st=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[u.ez,p.Bz.forChild(ot),F.O,A.c,r.COg,g.Ke,nt.s]}),n})()}}]);
//# sourceMappingURL=589.adad7808273df94b.js.map