"use strict";(self.webpackChunkdashboard=self.webpackChunkdashboard||[]).push([[232],{4042:(G,M,c)=>{c.d(M,{A2:()=>P,BC:()=>e,JY:()=>n,JZ:()=>C,K$:()=>f,X0:()=>B,fH:()=>m,i:()=>F,ir:()=>U,nY:()=>N,tY:()=>w,u:()=>D,vz:()=>t,zZ:()=>p});const n="/option",f="/role",D="/role/store",e="/role/{id}/update",P="/role/{id}/delete",F="/site/basic",C="/site/basic/save",w="/site/media",U="/site/media/save",B="/site/content",N="/site/content/save",m="/site/editor",t="/site/editor/save",p="/site/general/save"},5403:(G,M,c)=>{c.d(M,{C:()=>D});var n=c(2939),Z=c(8748),E=c(6796),f=c(4966);let D=(()=>{var e;class P{constructor(C){this.http=C}upload(C){const w={};return C.forEach(U=>{const B=new FormData;B.append("file",U,U.name);const N=new n.aW("POST",E.UE,B,{responseType:"json",reportProgress:!0}),m=new Z.x,t=new Z.x;(new Date).getTime(),this.http.request(N).subscribe({next(a){if(a.type===n.dt.UploadProgress){const _=Math.round(100*a.loaded/a.total);m.next(_)}else a instanceof n.Zn&&(t.next(a.body),m.complete())},error(a){t.next(a),m.complete()}}),w[U.name]={response:t,progress:m.asObservable()}}),w}}return(e=P).\u0275fac=function(C){return new(C||e)(f.LFG(n.eN))},e.\u0275prov=f.Yz7({token:e,factory:e.\u0275fac}),P})()},4494:(G,M,c)=>{c.d(M,{b:()=>k});var n=c(4014),Z=c(3226),E=c(2526),f=c(3008),D=c(4042),e=c(4966),P=c(2939),F=c(9089),C=c(6733),w=c(7285);const U=["nbTabsetComponent"];function B(g,y){if(1&g){const l=e.EpF();e.TgZ(0,"angular2-smart-table",10),e.NdJ("create",function(s){e.CHM(l);const r=e.oxw().index,b=e.oxw(2);return e.KtG(b.create(s,r))})("edit",function(s){e.CHM(l);const r=e.oxw().index,b=e.oxw(2);return e.KtG(b.edit(s,r))})("delete",function(s){e.CHM(l);const r=e.oxw().index,b=e.oxw(2);return e.KtG(b.delete(s,r))}),e.qZA()}if(2&g){const l=e.oxw().index,i=e.oxw(2);e.Q6J("settings",i.settings[l])("source",i.source[l])}}function N(g,y){if(1&g&&(e.TgZ(0,"button",17),e._uU(1),e.qZA()),2&g){const l=e.oxw(2).$implicit;e.xp6(),e.Oqu(l.form.reset.name)}}function m(g,y){if(1&g){const l=e.EpF();e.TgZ(0,"form",11),e.NdJ("submit",function(){e.CHM(l);const s=e.oxw(),r=s.index,b=s.$implicit,A=e.oxw(2);return e.KtG(A.submit(r,b.form.submit.link))}),e._UZ(1,"control-container",12),e.TgZ(2,"div",13),e._UZ(3,"label",14),e.TgZ(4,"div")(5,"button",15),e._uU(6),e.qZA(),e.YNc(7,N,2,1,"button",16),e.qZA()()()}if(2&g){const l=e.oxw(),i=l.$implicit,s=l.index,r=e.oxw(2);e.Q6J("ngClass",i.form.class)("formGroup",r.formGroup[s]),e.xp6(),e.Q6J("direction",i.form.direction)("form",r.formGroup[s])("controls",i.form.controls),e.xp6(),e.Tol("column"!==i.form.direction?"row":""),e.xp6(),e.Tol("column"!==i.form.direction?"col-12 col-md-2":""),e.xp6(),e.Tol("column"!==i.form.direction?"col-12 col-md-10":""),e.xp6(),e.Q6J("disabled",i.form.submit.valid&&r.formGroup[s].invalid),e.xp6(),e.Oqu(i.form.submit.name),e.xp6(),e.Q6J("ngIf",i.form.reset)}}function t(g,y){if(1&g&&(e.TgZ(0,"nb-tab",9),e.ynx(1,2),e.YNc(2,B,1,2,"angular2-smart-table",4)(3,m,8,14,"form",5),e.BQk(),e.qZA()),2&g){const l=y.$implicit,i=y.index;e.Q6J("active",0==i)("tabTitle",l.title)("tabIndex",i)("tabId",""+i),e.xp6(),e.Q6J("ngSwitch",l.container),e.xp6(),e.Q6J("ngSwitchCase","table"),e.xp6(),e.Q6J("ngSwitchCase","form")}}function p(g,y){if(1&g){const l=e.EpF();e.TgZ(0,"nb-tabset",6,7),e.NdJ("changeTab",function(s){e.CHM(l);const r=e.oxw();return e.KtG(r.changeTab(s))}),e.YNc(2,t,4,7,"nb-tab",8),e.qZA()}if(2&g){const l=e.oxw();e.xp6(2),e.Q6J("ngForOf",l.tabs)}}function a(g,y){if(1&g){const l=e.EpF();e.TgZ(0,"angular2-smart-table",10),e.NdJ("create",function(s){e.CHM(l);const r=e.oxw();return e.KtG(r.create(s,0))})("edit",function(s){e.CHM(l);const r=e.oxw();return e.KtG(r.edit(s,0))})("delete",function(s){e.CHM(l);const r=e.oxw();return e.KtG(r.delete(s,0))}),e.qZA()}if(2&g){const l=e.oxw();e.Q6J("settings",l.settings[0])("source",l.source[0])}}function _(g,y){if(1&g&&(e.TgZ(0,"button",17),e._uU(1),e.qZA()),2&g){const l=e.oxw(2);e.xp6(),e.Oqu(l.form.reset.name)}}function x(g,y){if(1&g){const l=e.EpF();e.TgZ(0,"form",11),e.NdJ("submit",function(){e.CHM(l);const s=e.oxw();return e.KtG(s.submit(0,s.form.submit.link))}),e._UZ(1,"control-container",12),e.TgZ(2,"div",18),e._UZ(3,"label",14),e.TgZ(4,"div")(5,"button",19),e._uU(6),e.qZA(),e.YNc(7,_,2,1,"button",16),e.qZA()()()}if(2&g){const l=e.oxw();e.Q6J("ngClass",l.form.class)("formGroup",l.formGroup[0]),e.xp6(),e.Q6J("direction",l.form.direction)("form",l.formGroup[0])("controls",l.form.controls),e.xp6(),e.Tol("column"!==l.form.direction?"row":""),e.xp6(),e.Tol("column"!==l.form.direction?"col-12 col-md-2":""),e.xp6(),e.Tol("column"!==l.form.direction?"col-12 col-md-10":""),e.xp6(),e.Q6J("disabled",l.form.submit.valid&&l.formGroup[0].invalid),e.xp6(),e.Oqu(l.form.submit.name),e.xp6(),e.Q6J("ngIf",l.form.reset)}}let k=(()=>{var g;class y{constructor(i,s,r,b){this.http=i,this.toast=s,this.route=r,this.router=b,this.title="",this.container="",this.tabs=[],this.settings=[],this.source=[],this.formGroup=[],this.controlDefaultValues=[],this.pluginLink="",this.editNotify=!1}ngOnInit(){this.route.queryParamMap.subscribe(i=>{let s=i.get("page")??"";s?(this.pluginLink=s.replace("/backend",""),this.http.get(this.pluginLink).subscribe(r=>{switch(this.title=r.title,this.container=r.container,this.container){case"tabs":this.tabs=r.tabs,this.tabs.forEach((b,A)=>{if("table"==b.container)this.source[A]=this.getSource(b.table?.source.default),this.settings[A]=this.getSettings(b.table);else{this.formGroup[A]=new Z.cw((0,n.T)(b.form?.controls));let I={};b.form?.controls.forEach(S=>{I[S.id]=S.value}),this.controlDefaultValues[A]=I}});break;case"form":this.form=r.form,this.formGroup[0]=new Z.cw((0,n.T)(this.form?.controls));break;case"table":this.table=r.table,this.source[0]=this.getSource(this.table.source.default),this.settings[0]=this.getSettings(this.table)}})):this.router.navigateByUrl("/404").then()})}create(i,s){this.tabSwitch(i,s,"add")}edit(i,s){this.tabSwitch(i,s,"edit")}tabSwitch(i,s,r){let b="";if(b=this.tabs.length>0?this.tabs[s].table?.source[r]:this.table?.source[r],b.startsWith("#/"))this.router.navigateByUrl(b);else if(b.startsWith("#")){let A=parseInt(b[1]),I=this.tabsetComponent?.tabs?.get(A);if(I){if("edit"==r)for(let S in this.formGroup[A].controls)this.formGroup[A].controls[S].setValue(i.data[S]);this.editNotify=!0,this.tabsetComponent?.selectTab(I)}}}delete(i,s){let r="";r=this.tabs.length>0?this.tabs[s].table?.source.delete:this.table?.source.delete,this.http.post(r,i.data).subscribe()}getSettings(i){let s=i.columns;for(let r in s)("image"===s[r].type||"status"===s[r].type)&&("image"===s[r].type&&(s[r].valuePrepareFunction=(b,A)=>b?(console.log(A.getRow().getData()),`<img alt="" width="50" src="${A.getRow().getData()[r+"_url"]}" />`):""),"status"===s[r].type&&(s[r].valuePrepareFunction=(b,A)=>{let I=A.getRow().getData(),S=b,Q="primary";return I.hasOwnProperty(r+"_text")&&(S=I[r+"_text"]),I.hasOwnProperty(r+"_class")&&(Q=I[r+"_class"]),`<span class="badge text-bg-${Q}">${S}</span>`}),s[r].type="html");return{actions:{position:"right",add:i.actions.add,edit:i.actions.edit,delete:i.actions.delete,columnTitle:"\u64cd\u4f5c"},add:{addButtonContent:'<i class="nb-plus"></i>',createButtonContent:'<i class="nb-checkmark"></i>',cancelButtonContent:'<i class="nb-close"></i>'},edit:{editButtonContent:'<i class="nb-edit"></i>',saveButtonContent:'<i class="nb-checkmark"></i>',cancelButtonContent:'<i class="nb-close"></i>'},delete:{deleteButtonContent:'<i class="nb-trash"></i>',confirmDelete:!0},pager:{perPage:30},mode:"external",columns:s}}getSource(i){return new f.zV(this.http,{endPoint:i,dataKey:"records",totalKey:"total",pagerPageKey:"page",pagerLimitKey:"limit",filterFieldKey:"#field#"})}changeTab(i){let s=parseInt(i.tabId);this.editNotify||this.formGroup[s]&&this.formGroup[s].setValue(this.controlDefaultValues[s]),this.editNotify=!1}submit(i,s){this.formGroup[i].invalid||((""==s||"#"==s||"/"==s)&&(s=D.zZ),this.http.post(s,this.formGroup[i].getRawValue(),{params:{page:this.pluginLink}}).subscribe(r=>{}))}}return(g=y).\u0275fac=function(i){return new(i||g)(e.Y36(P.eN),e.Y36(E.quB),e.Y36(F.gz),e.Y36(F.F0))},g.\u0275cmp=e.Xpm({type:g,selectors:[["app-plugin-feature"]],viewQuery:function(i,s){if(1&i&&e.Gf(U,5,E.kyn),2&i){let r;e.iGM(r=e.CRH())&&(s.tabsetComponent=r.first)}},decls:10,vars:5,consts:[[1,"row"],[1,"col-12"],[3,"ngSwitch"],[3,"changeTab",4,"ngSwitchCase"],[3,"settings","source","create","edit","delete",4,"ngSwitchCase"],[3,"ngClass","formGroup","submit",4,"ngSwitchCase"],[3,"changeTab"],["nbTabsetComponent",""],[3,"active","tabTitle","tabIndex","tabId",4,"ngFor","ngForOf"],[3,"active","tabTitle","tabIndex","tabId"],[3,"settings","source","create","edit","delete"],[3,"ngClass","formGroup","submit"],[3,"direction","form","controls"],[1,""],[1,"label","col-form-label"],["status","primary","size","small","nbButton","","type","submit",3,"disabled"],["status","danger","class","ms-2","size","small","type","reset","nbButton","",4,"ngIf"],["status","danger","size","small","type","reset","nbButton","",1,"ms-2"],[1,"form-group"],["status","primary","size","small","type","submit","nbButton","",3,"disabled"]],template:function(i,s){1&i&&(e.TgZ(0,"div",0)(1,"div",1)(2,"nb-card")(3,"nb-card-header"),e._uU(4),e.qZA(),e.TgZ(5,"nb-card-body"),e.ynx(6,2),e.YNc(7,p,3,1,"nb-tabset",3)(8,a,1,2,"angular2-smart-table",4)(9,x,8,14,"form",5),e.BQk(),e.qZA()()()()),2&i&&(e.xp6(4),e.Oqu(s.title),e.xp6(2),e.Q6J("ngSwitch",s.container),e.xp6(),e.Q6J("ngSwitchCase","tabs"),e.xp6(),e.Q6J("ngSwitchCase","table"),e.xp6(),e.Q6J("ngSwitchCase","form"))},dependencies:[C.mk,C.sg,C.O5,C.RF,C.n9,Z._Y,Z.JL,Z.sg,E.Asz,E.yKW,E.ndF,E.kyn,E.TR4,E.DPz,f.i0,w._],styles:["[_nghost-%COMP%]     nb-tab{overflow:hidden!important}"]}),y})()},8232:(G,M,c)=>{c.r(M),c.d(M,{PluginModule:()=>R});var n=c(6733),Z=c(2953),E=c(3507),f=c(2939);const C="/plugin/upload";var N=c(1925),m=c(3361),t=c(4966),p=c(2526),a=c(9089),_=c(2890);function x(d,T){if(1&d&&(t.TgZ(0,"a",17),t._uU(1),t.qZA()),2&d){const u=T.$implicit;t.Q6J("href",u.homepage?u.homepage:"#",t.LSH),t.xp6(),t.Oqu(u.name)}}function k(d,T){if(1&d){const u=t.EpF();t.TgZ(0,"button",18),t.NdJ("click",function(){t.CHM(u);const h=t.oxw().$implicit,v=t.oxw();return t.KtG(v.upgrade(h.packageName))}),t._UZ(1,"nb-icon",19),t.qZA()}}function g(d,T){if(1&d&&(t.TgZ(0,"a",21),t._uU(1),t.qZA()),2&d){const u=T.$implicit;t.Q6J("routerLink",u.link)("queryParams",u.query),t.xp6(),t.hij(" ",u.name||"\u8bbe\u7f6e"," ")}}function y(d,T){if(1&d&&(t.TgZ(0,"nb-card-footer",12),t.YNc(1,g,2,3,"a",20),t.qZA()),2&d){const u=t.oxw().$implicit;t.xp6(),t.Q6J("ngForOf",u.actions)}}function l(d,T){if(1&d){const u=t.EpF();t.TgZ(0,"div",8)(1,"nb-card")(2,"nb-card-header"),t._uU(3),t.qZA(),t.TgZ(4,"nb-card-body")(5,"div",9),t._uU(6),t.qZA(),t.TgZ(7,"div",10)(8,"span"),t._uU(9,"\u4f5c\u8005:"),t.qZA(),t.TgZ(10,"span"),t.YNc(11,x,2,2,"a",11),t.qZA()(),t.TgZ(12,"div",10)(13,"span"),t._uU(14,"\u7248\u672c:"),t.qZA(),t.TgZ(15,"span"),t._uU(16),t.qZA()()(),t.TgZ(17,"nb-card-footer",12)(18,"button",13),t.NdJ("click",function(){const v=t.CHM(u).$implicit,O=t.oxw();return t.KtG(O.remove(v.packageName))}),t._uU(19,"\u5220\u9664"),t.qZA(),t.TgZ(20,"div",3)(21,"button",14),t.NdJ("click",function(){const v=t.CHM(u).$implicit,O=t.oxw();return t.KtG(v.enabled?O.inactivate(v.packageName):O.activate(v.packageName))}),t._uU(22),t.qZA(),t.YNc(23,k,2,0,"button",15),t.qZA()(),t.YNc(24,y,2,1,"nb-card-footer",16),t.qZA()()}if(2&d){const u=T.$implicit,o=t.oxw();t.xp6(3),t.hij(" ",u.name," "),t.xp6(3),t.hij(" ",u.description," "),t.xp6(5),t.Q6J("ngForOf",u.authors),t.xp6(5),t.Oqu(u.version),t.xp6(2),t.Q6J("disabled",u.enabled||o.spinner)("nbSpinner",o.spinner),t.xp6(3),t.Q6J("disabled",o.spinner)("nbSpinner",o.spinner)("status",u.enabled?"control":"primary"),t.xp6(),t.hij(" ",u.enabled?"\u7981\u7528":"\u542f\u7528"," "),t.xp6(),t.Q6J("ngIf",u.upgradeable),t.xp6(),t.Q6J("ngIf",u.enabled&&u.actions.length>0)}}function i(d,T){if(1&d){const u=t.EpF();t.TgZ(0,"nb-card")(1,"nb-card-header"),t._uU(2,"\u5728\u7ebf\u4e0b\u8f7d"),t.qZA(),t.TgZ(3,"nb-card-body"),t._UZ(4,"input",22,23),t.qZA(),t.TgZ(6,"nb-card-footer",12)(7,"button",24),t.NdJ("click",function(){const v=t.CHM(u).dialogRef;return t.KtG(v.close())}),t._uU(8,"\u53d6\u6d88"),t.qZA(),t.TgZ(9,"button",25),t.NdJ("click",function(){const v=t.CHM(u).dialogRef,O=t.MAs(5),J=t.oxw();return t.KtG(J.openDownload(O.value,v))}),t._uU(10,"\u4e0b\u8f7d"),t.qZA()()()}}const s=()=>["zip"];let r=(()=>{var d;class T{constructor(o,h,v,O,J){this.http=o,this.toast=h,this.route=v,this.dialog=O,this.sidebar=J,this.plugins=[],this.title="",this.spinner=!1}onSpinner(o){this.spinner=o}ngAfterViewInit(){(0,N.H)(0).subscribe(o=>{this.sidebar.getSidebarState("menu-sidebar").subscribe(h=>{"compacted"!==h&&this.sidebar.compact("menu-sidebar")})})}ngOnInit(){this.getPlugins(),this.route.data.subscribe(o=>{this.title=o.title})}getPlugins(){this.http.get("/plugin/installed").subscribe(o=>{o.records.length>0&&(this.plugins=o.records)})}inactivate(o){this.http.post("/plugin/{name}/deactivate",{name:o},{context:(new f.qT).set(m.a,this)}).subscribe(h=>{this.getPlugins()})}activate(o){this.http.post("/plugin/{name}/activate",{name:o},{context:(new f.qT).set(m.a,this)}).subscribe(h=>{this.getPlugins()})}upgrade(o){this.http.post("/plugin/{name}/upgrade",{name:o},{context:(new f.qT).set(m.a,this)}).subscribe(h=>{this.getPlugins()})}upload(o){o.length<1?this.toast.danger("\u4e0a\u4f20\u7684\u63d2\u4ef6\u6587\u4ef6\u4e3a\u7a7a","\u4e0a\u4f20\u63d2\u4ef6"):this.http.post(C,{uri:o.pop()}).subscribe(h=>{this.getPlugins()})}openDownload(o,h){/https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\+.~#?&//=]*)/.test(o)?this.http.post(C,{uri:o}).subscribe(O=>{h.close(),this.getPlugins()}):this.toast.danger("\u4e0d\u5408\u6cd5\u7684url\u94fe\u63a5","\u5728\u7ebf\u4e0b\u8f7d")}remove(o){this.http.post("/plugin/{name}/down",{name:o},{context:(new f.qT).set(m.a,this)}).subscribe(h=>{this.getPlugins()})}}return(d=T).\u0275fac=function(o){return new(o||d)(t.Y36(f.eN),t.Y36(p.quB),t.Y36(a.gz),t.Y36(p.Gln),t.Y36(p.lzT))},d.\u0275cmp=t.Xpm({type:d,selectors:[["app-plugin-installed"]],decls:13,vars:4,consts:[[1,"row"],[1,"col-12"],[1,"d-flex","justify-content-between","align-items-center"],[1,"d-flex"],["nbButton","","status","danger",1,"me-2",3,"click"],[3,"suffix","status","finish"],["class","col-12 col-md-6 col-lg-4 col-xl-3",4,"ngFor","ngForOf"],["dialogTpl",""],[1,"col-12","col-md-6","col-lg-4","col-xl-3"],[1,"description"],[1,"d-flex","py-3","justify-content-between"],["class","d-inline-block mr-1","target","_blank",3,"href",4,"ngFor","ngForOf"],[1,"d-flex","justify-content-between"],["nbButton","","status","danger",3,"disabled","nbSpinner","click"],["nbButton","",3,"disabled","nbSpinner","status","click"],["class","ms-2","nbButton","","status","control",3,"click",4,"ngIf"],["class","d-flex justify-content-between",4,"ngIf"],["target","_blank",1,"d-inline-block","mr-1",3,"href"],["nbButton","","status","control",1,"ms-2",3,"click"],["icon","sync-outline"],["nbButton","","status","primary",3,"routerLink","queryParams",4,"ngFor","ngForOf"],["nbButton","","status","primary",3,"routerLink","queryParams"],["nbInput","","name","url","type","url","placeholder","\u4e0b\u8f7d\u5730\u5740"],["url",""],["nbButton","","status","basic",3,"click"],["nbButton","","status","primary",3,"click"]],template:function(o,h){if(1&o){const v=t.EpF();t.TgZ(0,"div",0)(1,"div",1)(2,"nb-card")(3,"nb-card-header",2)(4,"span"),t._uU(5,"\u5df2\u5b89\u88c5\u63d2\u4ef6\u5217\u8868"),t.qZA(),t.TgZ(6,"div",3)(7,"button",4),t.NdJ("click",function(){t.CHM(v);const J=t.MAs(12);return t.KtG(h.dialog.open(J))}),t._uU(8,"\u5728\u7ebf\u4e0b\u8f7d"),t.qZA(),t.TgZ(9,"app-upload",5),t.NdJ("finish",function(J){return h.upload(J)}),t.qZA()()()()(),t.YNc(10,l,25,12,"div",6),t.qZA(),t.YNc(11,i,11,0,"ng-template",null,7,t.W1O)}2&o&&(t.xp6(9),t.Q6J("suffix",t.DdM(3,s))("status","primary"),t.xp6(),t.Q6J("ngForOf",h.plugins))},dependencies:[n.sg,n.O5,a.rH,p.Asz,p.yKW,p.XWE,p.ndF,p.DPz,p.h8i,p.Q7R,p.fMN,_.o],encapsulation:2}),T})();var b=c(3232);function A(d,T){if(1&d&&(t.TgZ(0,"a",9),t._uU(1),t.qZA()),2&d){const u=T.$implicit;t.Q6J("href",u.homepage?u.homepage:"#",t.LSH),t.xp6(),t.hij(" ",u.name," ")}}function I(d,T){if(1&d){const u=t.EpF();t.TgZ(0,"div",3)(1,"nb-card")(2,"nb-card-header"),t._uU(3),t.qZA(),t.TgZ(4,"nb-card-body")(5,"div",4),t._uU(6),t.qZA(),t.TgZ(7,"div",5)(8,"span"),t._uU(9,"\u4f5c\u8005:"),t.qZA(),t.TgZ(10,"span"),t.YNc(11,A,2,2,"a",6),t.qZA()(),t.TgZ(12,"div",5)(13,"span"),t._uU(14,"\u7248\u672c:"),t.qZA(),t.TgZ(15,"span"),t._uU(16),t.qZA()()(),t.TgZ(17,"nb-card-footer",7)(18,"button",8),t.NdJ("click",function(){const v=t.CHM(u).$implicit,O=t.oxw();return t.KtG(O.setup(v.packageName))}),t._uU(19),t.qZA()()()()}if(2&d){const u=T.$implicit,o=t.oxw();t.xp6(3),t.Oqu(u.name),t.xp6(3),t.hij(" ",u.description," "),t.xp6(5),t.Q6J("ngForOf",u.authors),t.xp6(5),t.Oqu(u.version),t.xp6(2),t.Q6J("disabled",u.installed||o.spinner)("nbSpinner",o.spinner),t.xp6(),t.Oqu(u.installed?"\u5df2\u5b89\u88c5":"\u5b89\u88c5")}}let S=(()=>{var d;class T{constructor(o,h,v,O,J){this.http=o,this.toast=h,this.route=v,this.sanitizer=O,this.sidebar=J,this.plugins=[],this.title="",this.spinner=!1}onSpinner(o){this.spinner=o}ngAfterViewInit(){(0,N.H)(0).subscribe(o=>{this.sidebar.getSidebarState("menu-sidebar").subscribe(h=>{"compacted"!==h&&this.sidebar.compact("menu-sidebar")})})}ngOnInit(){this.getPlugins(),this.route.data.subscribe(o=>{this.title=o.title})}getPlugins(){this.http.get("/plugin/market").subscribe(o=>{o.records.length>0&&(this.plugins=o.records)})}setup(o){this.http.post("/plugin/{name}/setup",{name:o},{context:(new f.qT).set(m.a,this)}).subscribe(h=>{this.getPlugins()})}}return(d=T).\u0275fac=function(o){return new(o||d)(t.Y36(f.eN),t.Y36(p.quB),t.Y36(a.gz),t.Y36(b.H7),t.Y36(p.lzT))},d.\u0275cmp=t.Xpm({type:d,selectors:[["app-plugin-market"]],decls:6,vars:1,consts:[[1,"row"],[1,"col-12"],["class","col-12 col-md-6 col-lg-4 col-xl-3",4,"ngFor","ngForOf"],[1,"col-12","col-md-6","col-lg-4","col-xl-3"],[1,"description"],[1,"d-flex","py-3","justify-content-between"],["class","d-inline-block mr-1","target","_blank",3,"href",4,"ngFor","ngForOf"],[1,"d-flex","justify-content-end"],["nbButton","","status","primary",3,"disabled","nbSpinner","click"],["target","_blank",1,"d-inline-block","mr-1",3,"href"]],template:function(o,h){1&o&&(t.TgZ(0,"div",0)(1,"div",1)(2,"nb-card")(3,"nb-card-header"),t._uU(4," \u63d2\u4ef6\u5e02\u573a "),t.qZA()()(),t.YNc(5,I,20,7,"div",2),t.qZA()),2&o&&(t.xp6(5),t.Q6J("ngForOf",h.plugins))},dependencies:[n.sg,p.Asz,p.yKW,p.XWE,p.ndF,p.DPz,p.Q7R],encapsulation:2}),T})();var Q=c(4494),K=c(3235),L=c(3008);const q=[{path:"market",title:"\u63d2\u4ef6\u5e02\u573a",component:S},{path:"installed",title:"\u5df2\u5b89\u88c5\u63d2\u4ef6",component:r},{path:"feature",component:Q.b}];let R=(()=>{var d;class T{}return(d=T).\u0275fac=function(o){return new(o||d)},d.\u0275mod=t.oAB({type:d}),d.\u0275inj=t.cJS({imports:[n.ez,a.Bz.forChild(q),Z.O,E.c,p.COg,L.Ke,K.s]}),T})()},2890:(G,M,c)=>{c.d(M,{o:()=>N});var n=c(4966),Z=c(319),E=c(5403),f=c(2526),D=c(6733);const e=["file"];function P(m,t){if(1&m&&(n.TgZ(0,"nb-progress-bar",18),n.ALo(1,"async"),n._uU(2),n.qZA()),2&m){const p=n.oxw().$implicit,a=n.oxw();n.Q6J("status",a.messages[p.name]?"danger":"success")("displayValue",!a.messages[p.name])("value",n.lcZ(1,4,a.progress[p.name].progress)),n.xp6(2),n.hij(" ",a.messages[p.name]," ")}}function F(m,t){if(1&m){const p=n.EpF();n.TgZ(0,"div",13)(1,"nb-icon",19),n.NdJ("click",function(){n.CHM(p);const _=n.oxw().$implicit,x=n.oxw();return n.KtG(x.remove(_))}),n.qZA()()}}function C(m,t){if(1&m&&(n.TgZ(0,"nb-list-item")(1,"div",12)(2,"div",13),n._UZ(3,"nb-icon",14),n.qZA(),n.TgZ(4,"div",15),n._uU(5),n.qZA(),n.TgZ(6,"div",15),n.YNc(7,P,3,6,"nb-progress-bar",16),n.qZA(),n.YNc(8,F,2,0,"div",17),n.qZA()()),2&m){const p=t.$implicit,a=n.oxw();n.xp6(5),n.hij(" ",p.name," "),n.xp6(2),n.Q6J("ngIf",a.progress),n.xp6(),n.Q6J("ngIf",!a.uploading&&!a.uploadSuccessful)}}function w(m,t){if(1&m&&(n.TgZ(0,"div",20),n._uU(1),n.qZA()),2&m){const p=n.oxw();n.xp6(),n.hij(" ",p.errorMessage," ")}}function U(m,t){if(1&m){const p=n.EpF();n.TgZ(0,"button",21),n.NdJ("click",function(){n.CHM(p);const _=n.oxw();return n.KtG(_.dialogRef.close())}),n._uU(1,"\u53d6\u6d88"),n.qZA()}}let B=(()=>{var m;class t{constructor(a,_){this.dialogRef=a,this.uploadService=_,this.files=new Set,this.multiple=!1,this.suffix=[],this.canBeClosed=!0,this.primaryButtonText="\u4e0a\u4f20",this.showCancelButton=!0,this.uploading=!1,this.uploadSuccessful=!1,this.messages={},this.errorMessage="",this.results=[]}ngOnInit(){}onFilesAdded(){const a=this.file?.nativeElement.files;let _="";for(const x in a){if(isNaN(parseInt(x,10)))continue;let k=a[x];console.log(k);let g=k.name.split(".");this.suffix.length>0&&!this.suffix.includes(g[g.length-1].toLowerCase())?_="\u6b64\u6587\u4ef6\u7c7b\u578b\u4e0d\u652f\u6301\uff0c\u53ea\u652f\u6301: "+this.suffix.join(",")+"\u6587\u4ef6\u683c\u5f0f":this.files.add(k)}this.errorMessage=_}addFiles(){this.file?.nativeElement.click()}closeDialog(){if(this.uploadSuccessful)return this.finish?.emit(this.results),this.dialogRef.close();if(this.files.size<1)return void(this.errorMessage="\u9009\u62e9\u9700\u8981\u4e0a\u4f20\u7684\u6587\u4ef6!");this.uploading=!0,this.progress=this.uploadService.upload(this.files);for(const _ in this.progress)this.progress[_].progress.subscribe(x=>console.log(x)),this.progress[_].response.subscribe(x=>{x.hasOwnProperty("statusText")?this.messages[_]=x.statusText:x.hasOwnProperty("status")&&"ok"!=x.status?this.messages[_]=x.message:this.results.push(x.filename)});const a=[];for(const _ in this.progress)a.push(this.progress[_].progress);this.primaryButtonText="\u5b8c\u6210",this.canBeClosed=!1,this.showCancelButton=!1,(0,Z.D)(a).subscribe(_=>{this.canBeClosed=!0,this.uploadSuccessful=!0,this.uploading=!1})}remove(a){this.files.delete(a)}}return(m=t).\u0275fac=function(a){return new(a||m)(n.Y36(f.X4l),n.Y36(E.C))},m.\u0275cmp=n.Xpm({type:m,selectors:[["app-dialog"]],viewQuery:function(a,_){if(1&a&&n.Gf(e,5),2&a){let x;n.iGM(x=n.CRH())&&(_.file=x.first)}},inputs:{multiple:"multiple",suffix:"suffix"},outputs:{finish:"finish"},features:[n._Bn([E.C])],decls:20,vars:7,consts:[[1,"row"],[1,"col-12"],["type","file",2,"display","none",3,"multiple","change"],["file",""],[1,"list-card"],[1,"d-flex","justify-content-between","align-items-center"],["nbButton","","status","primary",3,"disabled","click"],[4,"ngFor","ngForOf"],[1,"actions"],["class","col-12 text-danger py-2",4,"ngIf"],[1,"col-12","d-flex","justify-content-between"],["nbButton","","status","control","class","mr-2",3,"click",4,"ngIf"],[1,"row","flex-grow-1","flex-nowrap"],[1,"col-1"],["status","primary","icon","file"],[1,"col-5"],[3,"status","displayValue","value",4,"ngIf"],["class","col-1",4,"ngIf"],[3,"status","displayValue","value"],["icon","close","status","danger",2,"cursor","pointer",3,"click"],[1,"col-12","text-danger","py-2"],["nbButton","","status","control",1,"mr-2",3,"click"]],template:function(a,_){1&a&&(n.TgZ(0,"div",0)(1,"div",1)(2,"input",2,3),n.NdJ("change",function(){return _.onFilesAdded()}),n.qZA(),n.TgZ(4,"nb-card",4)(5,"nb-card-header",5)(6,"span"),n._uU(7,"\u4e0a\u4f20\u6587\u4ef6"),n.qZA(),n.TgZ(8,"button",6),n.NdJ("click",function(){return _.addFiles()}),n._uU(9,"\u6dfb\u52a0\u6587\u4ef6"),n.qZA()(),n.TgZ(10,"nb-card-body")(11,"nb-list"),n.YNc(12,C,9,3,"nb-list-item",7),n.qZA()(),n.TgZ(13,"nb-card-footer",8)(14,"div",0),n.YNc(15,w,2,1,"div",9),n.TgZ(16,"div",10),n.YNc(17,U,2,0,"button",11),n.TgZ(18,"button",6),n.NdJ("click",function(){return _.closeDialog()}),n._uU(19),n.qZA()()()()()()()),2&a&&(n.xp6(2),n.Q6J("multiple",_.multiple),n.xp6(6),n.Q6J("disabled",_.uploading||_.uploadSuccessful),n.xp6(4),n.Q6J("ngForOf",_.files),n.xp6(3),n.Q6J("ngIf",_.errorMessage.length>0),n.xp6(2),n.Q6J("ngIf",_.showCancelButton),n.xp6(),n.Q6J("disabled",!_.canBeClosed||_.files.size<1),n.xp6(),n.Oqu(_.primaryButtonText))},dependencies:[D.sg,D.O5,f.DPz,f.bSZ,f.zP_,f.qBV,f.Asz,f.yKW,f.XWE,f.ndF,f.fMN,D.Ov],styles:["nb-card[_ngcontent-%COMP%]{min-width:290px}.list-card[_ngcontent-%COMP%]   nb-card-header[_ngcontent-%COMP%]{border-bottom:none}.list-card[_ngcontent-%COMP%]   nb-card-footer[_ngcontent-%COMP%]{border-top:none}.list-card[_ngcontent-%COMP%]   nb-card-body[_ngcontent-%COMP%]{padding:0}"]}),t})(),N=(()=>{var m;class t{constructor(a){this.dialog=a,this.multiple=!1,this.text="\u4e0a\u4f20",this.status="primary",this.suffix=[],this.finish=new n.vpe}openUploadDialog(){const a=this.dialog.open(B,{closeOnBackdropClick:!1,closeOnEsc:!1});a.componentRef.instance.multiple=this.multiple,a.componentRef.instance.finish=this.finish,a.componentRef.instance.suffix=this.suffix}}return(m=t).\u0275fac=function(a){return new(a||m)(n.Y36(f.Gln))},m.\u0275cmp=n.Xpm({type:m,selectors:[["app-upload"]],inputs:{multiple:"multiple",text:"text",status:"status",suffix:"suffix"},outputs:{finish:"finish"},decls:2,vars:2,consts:[["type","button","nbButton","",3,"status","click"]],template:function(a,_){1&a&&(n.TgZ(0,"button",0),n.NdJ("click",function(){return _.openUploadDialog()}),n._uU(1),n.qZA()),2&a&&(n.Q6J("status",_.status),n.xp6(),n.Oqu(_.text))},dependencies:[f.DPz],styles:["[_nghost-%COMP%]{display:block}"]}),t})()},3507:(G,M,c)=>{c.d(M,{c:()=>D});var n=c(6733),Z=c(2526),E=c(5403),f=c(4966);let D=(()=>{var e;class P{}return(e=P).\u0275fac=function(C){return new(C||e)},e.\u0275mod=f.oAB({type:e}),e.\u0275inj=f.cJS({providers:[E.C],imports:[n.ez,Z.T2N,Z.DfH,Z.COg,Z.zyh,Z.KdK]}),P})()}}]);